
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The Unity Machine Learning Agents Toolkit (ML-Agents) is an open-source project that enables games and simulations to serve as environments for training intelligent agents.">
      
      
        <meta name="author" content="Unity Technologies">
      
      
        <link rel="canonical" href="https://unity-technologies.github.io/ml-agents/Python-Gym-API/">
      
      
        <link rel="prev" href="../Background-Unity/">
      
      
        <link rel="next" href="../Python-PettingZoo-API/">
      
      
      <link rel="icon" href="../images/unity-logo-black.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>Getting started with the Gym API - Unity ML-Agents Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bd3936ea.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#unity-ml-agents-gym-wrapper" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Unity ML-Agents Toolkit" class="md-header__button md-logo" aria-label="Unity ML-Agents Toolkit" data-md-component="logo">
      
  <img src="../images/unity-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Unity ML-Agents Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Getting started with the Gym API
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Unity-Technologies/ml-agents" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Unity ML-Agents Toolkit" class="md-nav__button md-logo" aria-label="Unity ML-Agents Toolkit" data-md-component="logo">
      
  <img src="../images/unity-logo.png" alt="logo">

    </a>
    Unity ML-Agents Toolkit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Unity-Technologies/ml-agents" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../ML-Agents-Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ML-Agents Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../ML-Agents-Toolkit-Documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Toolkit Documentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Background
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Background
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Background-Machine-Learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Machine Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Background-PyTorch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Background-Unity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unity
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Interfacing with Unity Builds
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Interfacing with Unity Builds
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Getting started with the Gym API
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Getting started with the Gym API
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-gym-wrapper" class="md-nav__link">
    Using the Gym Wrapper
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-openai-baselines-algorithms" class="md-nav__link">
    Running OpenAI Baselines Algorithms
  </a>
  
    <nav class="md-nav" aria-label="Running OpenAI Baselines Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-dqn-baseline" class="md-nav__link">
    Example - DQN Baseline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-algorithms" class="md-nav__link">
    Other Algorithms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-google-dopamine-algorithms" class="md-nav__link">
    Run Google Dopamine Algorithms
  </a>
  
    <nav class="md-nav" aria-label="Run Google Dopamine Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adapting-dopamines-scripts" class="md-nav__link">
    Adapting Dopamine's Scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations_1" class="md-nav__link">
    Limitations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hyperparameters" class="md-nav__link">
    Hyperparameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starting-a-run" class="md-nav__link">
    Starting a Run
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-gridworld" class="md-nav__link">
    Example: GridWorld
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-PettingZoo-API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started with the PettingZoo API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-LLAPI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started with the LLAPI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python API Docs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Python API Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-Gym-API-Documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gym API Documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-PettingZoo-API-Documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Petting Zoo Documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-LLAPI-Documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LLAPI Documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Python-On-Off-Policy-Trainer-Documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    On/Off Policy Trainer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Tutorial-Custom-Trainer-Plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom Trainer Plugin
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../FAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Limitations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Limitations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Migrating/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migrating
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Versioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Versioning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-the-gym-wrapper" class="md-nav__link">
    Using the Gym Wrapper
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-openai-baselines-algorithms" class="md-nav__link">
    Running OpenAI Baselines Algorithms
  </a>
  
    <nav class="md-nav" aria-label="Running OpenAI Baselines Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-dqn-baseline" class="md-nav__link">
    Example - DQN Baseline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-algorithms" class="md-nav__link">
    Other Algorithms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-google-dopamine-algorithms" class="md-nav__link">
    Run Google Dopamine Algorithms
  </a>
  
    <nav class="md-nav" aria-label="Run Google Dopamine Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adapting-dopamines-scripts" class="md-nav__link">
    Adapting Dopamine's Scripts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations_1" class="md-nav__link">
    Limitations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hyperparameters" class="md-nav__link">
    Hyperparameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#starting-a-run" class="md-nav__link">
    Starting a Run
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-gridworld" class="md-nav__link">
    Example: GridWorld
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="unity-ml-agents-gym-wrapper">Unity ML-Agents Gym Wrapper</h1>
<p>A common way in which machine learning researchers interact with simulation
environments is via a wrapper provided by OpenAI called <code>gym</code>. For more
information on the gym interface, see <a href="https://github.com/openai/gym">here</a>.</p>
<p>We provide a gym wrapper and instructions for using it with existing machine
learning algorithms which utilize gym. Our wrapper provides interfaces on top of
our <code>UnityEnvironment</code> class, which is the default way of interfacing with a
Unity environment via Python.</p>
<h2 id="installation">Installation</h2>
<p>The gym wrapper is part of the <code>mlgents_envs</code> package. Please refer to the
<a href="../ML-Agents-Envs-README/">mlagents_envs installation instructions</a>.</p>
<h2 id="using-the-gym-wrapper">Using the Gym Wrapper</h2>
<p>The gym interface is available from <code>gym_unity.envs</code>. To launch an environment
from the root of the project repository use:</p>
<pre><code class="language-python">from mlagents_envs.envs.unity_gym_env import UnityToGymWrapper

env = UnityToGymWrapper(unity_env, uint8_visual, flatten_branched, allow_multiple_obs)
</code></pre>
<ul>
<li>
<p><code>unity_env</code> refers to the Unity environment to be wrapped.</p>
</li>
<li>
<p><code>uint8_visual</code> refers to whether to output visual observations as <code>uint8</code>
  values (0-255). Many common Gym environments (e.g. Atari) do this. By default
  they will be floats (0.0-1.0). Defaults to <code>False</code>.</p>
</li>
<li>
<p><code>flatten_branched</code> will flatten a branched discrete action space into a Gym
  Discrete. Otherwise, it will be converted into a MultiDiscrete. Defaults to
  <code>False</code>.</p>
</li>
<li>
<p><code>allow_multiple_obs</code> will return a list of observations. The first elements
  contain the visual observations and the last element contains the array of
  vector observations. If False the environment returns a single array (containing
  a single visual observations, if present, otherwise the vector observation).
  Defaults to <code>False</code>.</p>
</li>
<li>
<p><code>action_space_seed</code> is the optional seed for action sampling. If non-None, will
  be used to set the random seed on created gym.Space instances.</p>
</li>
</ul>
<p>The returned environment <code>env</code> will function as a gym.</p>
<h2 id="limitations">Limitations</h2>
<ul>
<li>It is only possible to use an environment with a <strong>single</strong> Agent.</li>
<li>By default, the first visual observation is provided as the <code>observation</code>, if
  present. Otherwise, vector observations are provided. You can receive all
  visual and vector observations by using the <code>allow_multiple_obs=True</code> option in
  the gym parameters. If set to <code>True</code>, you will receive a list of <code>observation</code>
  instead of only one.</li>
<li>The <code>TerminalSteps</code> or <code>DecisionSteps</code> output from the environment can still
  be accessed from the <code>info</code> provided by <code>env.step(action)</code>.</li>
<li>Stacked vector observations are not supported.</li>
<li>Environment registration for use with <code>gym.make()</code> is currently not supported.</li>
<li>Calling env.render() will not render a new frame of the environment. It will
  return the latest visual observation if using visual observations.</li>
</ul>
<h2 id="running-openai-baselines-algorithms">Running OpenAI Baselines Algorithms</h2>
<p>OpenAI provides a set of open-source maintained and tested Reinforcement
Learning algorithms called the <a href="https://github.com/openai/baselines">Baselines</a>.</p>
<p>Using the provided Gym wrapper, it is possible to train ML-Agents environments
using these algorithms. This requires the creation of custom training scripts to
launch each algorithm. In most cases these scripts can be created by making
slight modifications to the ones provided for Atari and Mujoco environments.</p>
<p>These examples were tested with baselines version 0.1.6.</p>
<h3 id="example-dqn-baseline">Example - DQN Baseline</h3>
<p>In order to train an agent to play the <code>GridWorld</code> environment using the
Baselines DQN algorithm, you first need to install the baselines package using
pip:</p>
<pre><code>pip install git+git://github.com/openai/baselines
</code></pre>
<p>Next, create a file called <code>train_unity.py</code>. Then create an <code>/envs/</code> directory
and build the environment to that directory. For more information on
building Unity environments, see
<a href="../docs/Learning-Environment-Executable.md">here</a>. Note that because of
limitations of the DQN baseline, the environment must have a single visual
observation, a single discrete action and a single Agent in the scene.
Add the following code to the <code>train_unity.py</code> file:</p>
<pre><code class="language-python">import gym

from baselines import deepq
from baselines import logger

from mlagents_envs.environment import UnityEnvironment
from mlagents_envs.envs.unity_gym_env import UnityToGymWrapper


def main():
  unity_env = UnityEnvironment( &lt; path - to - environment &gt;)
  env = UnityToGymWrapper(unity_env, uint8_visual=True)
  logger.configure('./logs')  # Change to log in a different directory
  act = deepq.learn(
    env,
    &quot;cnn&quot;,  # For visual inputs
    lr=2.5e-4,
    total_timesteps=1000000,
    buffer_size=50000,
    exploration_fraction=0.05,
    exploration_final_eps=0.1,
    print_freq=20,
    train_freq=5,
    learning_starts=20000,
    target_network_update_freq=50,
    gamma=0.99,
    prioritized_replay=False,
    checkpoint_freq=1000,
    checkpoint_path='./logs',  # Change to save model in a different directory
    dueling=True
  )
  print(&quot;Saving model to unity_model.pkl&quot;)
  act.save(&quot;unity_model.pkl&quot;)


if __name__ == '__main__':
  main()
</code></pre>
<p>To start the training process, run the following from the directory containing
<code>train_unity.py</code>:</p>
<pre><code class="language-sh">python -m train_unity
</code></pre>
<h3 id="other-algorithms">Other Algorithms</h3>
<p>Other algorithms in the Baselines repository can be run using scripts similar to
the examples from the baselines package. In most cases, the primary changes
needed to use a Unity environment are to import <code>UnityToGymWrapper</code>, and to
replace the environment creation code, typically <code>gym.make()</code>, with a call to
<code>UnityToGymWrapper(unity_environment)</code> passing the environment as input.</p>
<p>A typical rule of thumb is that for vision-based environments, modification
should be done to Atari training scripts, and for vector observation
environments, modification should be done to Mujoco scripts.</p>
<p>Some algorithms will make use of <code>make_env()</code> or <code>make_mujoco_env()</code> functions.
You can define a similar function for Unity environments. An example of such a
method using the PPO2 baseline:</p>
<pre><code class="language-python">from mlagents_envs.environment import UnityEnvironment
from mlagents_envs.envs import UnityToGymWrapper
from baselines.common.vec_env.subproc_vec_env import SubprocVecEnv
from baselines.common.vec_env.dummy_vec_env import DummyVecEnv
from baselines.bench import Monitor
from baselines import logger
import baselines.ppo2.ppo2 as ppo2

import os

try:
  from mpi4py import MPI
except ImportError:
  MPI = None


def make_unity_env(env_directory, num_env, visual, start_index=0):
  &quot;&quot;&quot;
  Create a wrapped, monitored Unity environment.
  &quot;&quot;&quot;

  def make_env(rank, use_visual=True):  # pylint: disable=C0111
    def _thunk():
      unity_env = UnityEnvironment(env_directory, base_port=5000 + rank)
      env = UnityToGymWrapper(unity_env, uint8_visual=True)
      env = Monitor(env, logger.get_dir() and os.path.join(logger.get_dir(), str(rank)))
      return env

    return _thunk

  if visual:
    return SubprocVecEnv([make_env(i + start_index) for i in range(num_env)])
  else:
    rank = MPI.COMM_WORLD.Get_rank() if MPI else 0
    return DummyVecEnv([make_env(rank, use_visual=False)])


def main():
  env = make_unity_env( &lt; path - to - environment &gt;, 4, True)
  ppo2.learn(
    network=&quot;mlp&quot;,
    env=env,
    total_timesteps=100000,
    lr=1e-3,
  )


if __name__ == '__main__':
  main()
</code></pre>
<h2 id="run-google-dopamine-algorithms">Run Google Dopamine Algorithms</h2>
<p>Google provides a framework <a href="https://github.com/google/dopamine">Dopamine</a>, and
implementations of algorithms, e.g. DQN, Rainbow, and the C51 variant of
Rainbow. Using the Gym wrapper, we can run Unity environments using Dopamine.</p>
<p>First, after installing the Gym wrapper, clone the Dopamine repository.</p>
<pre><code>git clone https://github.com/google/dopamine
</code></pre>
<p>Then, follow the appropriate install instructions as specified on
<a href="https://github.com/google/dopamine">Dopamine's homepage</a>. Note that the
Dopamine guide specifies using a virtualenv. If you choose to do so, make sure
your unity_env package is also installed within the same virtualenv as Dopamine.</p>
<h3 id="adapting-dopamines-scripts">Adapting Dopamine's Scripts</h3>
<p>First, open <code>dopamine/atari/run_experiment.py</code>. Alternatively, copy the entire
<code>atari</code> folder, and name it something else (e.g. <code>unity</code>). If you choose the
copy approach, be sure to change the package names in the import statements in
<code>train.py</code> to your new directory.</p>
<p>Within <code>run_experiment.py</code>, we will need to make changes to which environment is
instantiated, just as in the Baselines example. At the top of the file, insert</p>
<pre><code class="language-python">from mlagents_envs.environment import UnityEnvironment
from mlagents_envs.envs import UnityToGymWrapper
</code></pre>
<p>to import the Gym Wrapper. Navigate to the <code>create_atari_environment</code> method in
the same file, and switch to instantiating a Unity environment by replacing the
method with the following code.</p>
<pre><code class="language-python">    game_version = 'v0' if sticky_actions else 'v4'
    full_game_name = '{}NoFrameskip-{}'.format(game_name, game_version)
    unity_env = UnityEnvironment(&lt;path-to-environment&gt;)
    env = UnityToGymWrapper(unity_env, uint8_visual=True)
    return env
</code></pre>
<p><code>&lt;path-to-environment&gt;</code> is the path to your built Unity executable. For more
information on building Unity environments, see
<a href="../docs/Learning-Environment-Executable.md">here</a>, and note the Limitations
section below.</p>
<p>Note that we are not using the preprocessor from Dopamine, as it uses many
Atari-specific calls. Furthermore, frame-skipping can be done from within Unity,
rather than on the Python side.</p>
<h3 id="limitations_1">Limitations</h3>
<p>Since Dopamine is designed around variants of DQN, it is only compatible with
discrete action spaces, and specifically the Discrete Gym space. For
environments that use branched discrete action spaces, you can enable the
<code>flatten_branched</code> parameter in <code>UnityToGymWrapper</code>, which treats each
combination of branched actions as separate actions.</p>
<p>Furthermore, when building your environments, ensure that your Agent is using
visual observations with greyscale enabled, and that the dimensions of the
visual observations is 84 by 84 (matches the parameter found in <code>dqn_agent.py</code>
and <code>rainbow_agent.py</code>). Dopamine's agents currently do not automatically adapt
to the observation dimensions or number of channels.</p>
<h3 id="hyperparameters">Hyperparameters</h3>
<p>The hyperparameters provided by Dopamine are tailored to the Atari games, and
you will likely need to adjust them for ML-Agents environments. Here is a sample
<code>dopamine/agents/rainbow/configs/rainbow.gin</code> file that is known to work with
a simple GridWorld.</p>
<pre><code class="language-python">import dopamine.agents.rainbow.rainbow_agent
import dopamine.unity.run_experiment
import dopamine.replay_memory.prioritized_replay_buffer
import gin.tf.external_configurables

RainbowAgent.num_atoms = 51
RainbowAgent.stack_size = 1
RainbowAgent.vmax = 10.
RainbowAgent.gamma = 0.99
RainbowAgent.update_horizon = 3
RainbowAgent.min_replay_history = 20000  # agent steps
RainbowAgent.update_period = 5
RainbowAgent.target_update_period = 50  # agent steps
RainbowAgent.epsilon_train = 0.1
RainbowAgent.epsilon_eval = 0.01
RainbowAgent.epsilon_decay_period = 50000  # agent steps
RainbowAgent.replay_scheme = 'prioritized'
RainbowAgent.tf_device = '/cpu:0'  # use '/cpu:*' for non-GPU version
RainbowAgent.optimizer = @tf.train.AdamOptimizer()

tf.train.AdamOptimizer.learning_rate = 0.00025
tf.train.AdamOptimizer.epsilon = 0.0003125

Runner.game_name = &quot;Unity&quot; # any name can be used here
Runner.sticky_actions = False
Runner.num_iterations = 200
Runner.training_steps = 10000  # agent steps
Runner.evaluation_steps = 500  # agent steps
Runner.max_steps_per_episode = 27000  # agent steps

WrappedPrioritizedReplayBuffer.replay_capacity = 1000000
WrappedPrioritizedReplayBuffer.batch_size = 32
</code></pre>
<p>This example assumed you copied <code>atari</code> to a separate folder named <code>unity</code>.
Replace <code>unity</code> in <code>import dopamine.unity.run_experiment</code> with the folder you
copied your <code>run_experiment.py</code> and <code>trainer.py</code> files to. If you directly
modified the existing files, then use <code>atari</code> here.</p>
<h3 id="starting-a-run">Starting a Run</h3>
<p>You can now run Dopamine as you would normally:</p>
<pre><code>python -um dopamine.unity.train \
  --agent_name=rainbow \
  --base_dir=/tmp/dopamine \
  --gin_files='dopamine/agents/rainbow/configs/rainbow.gin'
</code></pre>
<p>Again, we assume that you've copied <code>atari</code> into a separate folder. Remember to
replace <code>unity</code> with the directory you copied your files into. If you edited the
Atari files directly, this should be <code>atari</code>.</p>
<h3 id="example-gridworld">Example: GridWorld</h3>
<p>As a baseline, here are rewards over time for the three algorithms provided with
Dopamine as run on the GridWorld example environment. All Dopamine (DQN,
Rainbow, C51) runs were done with the same epsilon, epsilon decay, replay
history, training steps, and buffer settings as specified above. Note that the
first 20000 steps are used to pre-fill the training buffer, and no learning
happens.</p>
<p>We provide results from our PPO implementation and the DQN from Baselines as
reference. Note that all runs used the same greyscale GridWorld as Dopamine. For
PPO, <code>num_layers</code> was set to 2, and all other hyperparameters are the default
for GridWorld in <code>config/ppo/GridWorld.yaml</code>. For Baselines DQN, the provided
hyperparameters in the previous section are used. Note that Baselines implements
certain features (e.g. dueling-Q) that are not enabled in Dopamine DQN.</p>
<p><img alt="Dopamine on GridWorld" src="../images/dopamine_gridworld_plot.png" /></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      com.unity.ml-agents copyright Â© 2017 - 2022 Unity Technologies
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.94c44541.min.js"></script>
      
    
  </body>
</html>